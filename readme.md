<div align="center">
  <img src="./assets//logo.png" />
  <h3>åŸºäºWebpackçš„è‡ªåŠ¨ç”Ÿæˆè·¯ç”±æ’ä»¶</h3>
  <p>
    <a href="https://www.npmjs.com/package/webpack-plugin-auto-routes">
      <img src="https://img.shields.io/badge/webpack-%3E%3D5-blue
      " />
    </a>
  </p>
</div>

---

## ä»‹ç»

ä¸€ä¸ªç®€æ´é«˜æ•ˆçš„ Webpack æ’ä»¶ï¼Œç”¨äºåŠ¨æ€ç”Ÿæˆè·¯ç”±æ–‡ä»¶ï¼Œå¸®åŠ©å¼€å‘è€…è½»æ¾å®ç°çº¦å®šå¼è·¯ç”±åŠŸèƒ½ã€‚

---

## ç‰¹æ€§

- ğŸ“‚ **åŠ¨æ€ç”Ÿæˆ**ï¼šæ ¹æ®æ–‡ä»¶ç›®å½•ç»“æ„è‡ªåŠ¨ç”Ÿæˆè·¯ç”±é…ç½®
- ğŸ› ï¸ **è·¯ç”±å…ƒä¿¡æ¯**ï¼šæ”¯æŒé€šè¿‡ `*.meta.json` æ–‡ä»¶ä¸ºæ¯ä¸ªè·¯ç”±é…ç½®é™„åŠ ä¿¡æ¯
- ğŸ¤ **åŠ¨æ€è·¯ç”±**ï¼šçº¦å®šä»¥`$`å¼€å¤´çš„æ–‡ä»¶ä¸ºåŠ¨æ€è·¯ç”±æ–‡ä»¶ï¼Œä¾‹å¦‚ `$id.tsx`
- âš™ï¸ **å¤šé¡µé¢å…¥å£**ï¼šæ”¯æŒé…ç½®å¤šä¸ªé¡µé¢å…¥å£ï¼Œé»˜è®¤ä»¥é¡µé¢å…¥å£ä¸‹çš„ `Layout.(jsx|tsx)` ä½œä¸ºå±€éƒ¨è·¯ç”±ï¼Œä¼˜å…ˆçº§é«˜äºå…¨å±€è·¯ç”±ï¼›ä¾‹å¦‚ `src/pages/Layout.tsx`
- ğŸ“ **å…¨å±€ Layout æ”¯æŒ**ï¼šé»˜è®¤ä½¿ç”¨ `src/layouts/index.(jsx|tsx)` æ–‡ä»¶ä½œä¸ºå…¨å±€è·¯ç”±æ–‡ä»¶

---

## å®‰è£…

```bash
npm install webpack-plugin-auto-routes --save-dev
or
yarn add webpack-plugin-auto-routes --dev
or
pnpm add webpack-plugin-auto-routes --save-dev
```

---

## ä½¿ç”¨æ–¹æ³•

### é…ç½®

åœ¨ `webpack.config.ts` ä¸­é…ç½®

```javascript
import WebpackPluginAutoRoutes from 'webpack-plugin-auto-routes';

export default {
  // ...å…¶ä»–é…ç½®é¡¹
  plugins: [
    new WebpackPluginAutoRoutes({
      // é…ç½®é¡¹
      dirs: '',
      moduleType: 'tsx',
    }),
  ],
};
```

### ä½¿ç”¨

```javascript
import { getRoutes } from 'virtual-routes';
```

å¼•å…¥ virtual:routes ä¼šå¯¼å‡º getRoutes æ–¹æ³•ï¼Œè¿”å›ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å« routes å’Œ routeComponents

```typescript
export const getRoutes: () => {
  routes: Record<
    string,
    {
      id: string;
      path: string;
      parentId: string;
      isLayout?: boolean;
      [key: string]: any;
    }
  >;
  routeComponents: Record<string, React.ComponentType<any>>;
};
```

### é…ç½®é¡¹

#### dirs

- **ç±»å‹**: `string | (string | dirOptions)[]`
- **é»˜è®¤å€¼**: `'src/pages'`

```typescript
interface dirOptions {
  /**
   * é¡µé¢å…¥å£
   * @default 'src/pages'
   */
  dir: string;
  /**
   * åŸºæœ¬è·¯å¾„
   * @default '/'
   */
  basePath?: string;
  /**
   * è¿‡æ»¤è§„åˆ™
   * @example /\.(jsx?|tsx)$/
   */
  pattern: RegExp;
}
```

ä¼ å…¥å¤šä¸ªç›®å½•æ—¶ï¼Œä¼šé€’å½’éå†æ¯ä¸ªç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œç”Ÿæˆå¯¹åº”çš„è·¯ç”±é…ç½®ï¼Œå¹¶å°†åŸºæœ¬è·¯å¾„åŠ å…¥ç”Ÿæˆçš„è·¯ç”±ã€‚

è¿˜å¯ä»¥ä½¿ç”¨ pattern è¿‡æ»¤æ–‡ä»¶ï¼Œä¾‹å¦‚åªç”Ÿæˆä»¥ `.tsx` ç»“å°¾çš„æ–‡ä»¶ã€‚

#### moduleType

- **ç±»å‹**: `jsx|tsx`
- **é»˜è®¤å€¼**: `'tsx'`

æŒ‡å®šç”Ÿæˆçš„è·¯ç”±æ–‡ä»¶ç±»å‹ï¼Œä¾‹å¦‚ `jsx`ã€`tsx` ã€‚

### è·¯ç”±å…ƒæ•°æ®

å…è®¸ç”¨æˆ·ä½¿ç”¨.meta.json æ–‡ä»¶ä¸ºæ¯ä¸ªè·¯ç”±é…ç½®é™„åŠ ä¿¡æ¯ï¼Œmeta æ–‡ä»¶å¿…é¡»æ”¾åœ¨ä¸è·¯ç”±æ–‡ä»¶åŒçº§ç›®å½•ä¸‹ï¼Œæ–‡ä»¶åå¿…é¡»ä»¥.meta.json ç»“å°¾ã€‚

ä½ å¯ä»¥åœ¨ meta ä¸­é…ç½®çš„å±æ€§æœ‰ï¼š

- `id`: è·¯ç”± idï¼Œé»˜è®¤ç”Ÿæˆï¼Œä¾‹å¦‚ `src/pages/about` ä¼šç”Ÿæˆ `about` ä½œä¸º idï¼Œæ­¤ id ä¼šåœ¨ routeComponents ä¸­å¯¹åº”ä¸€ä¸ªç»„ä»¶
- `path`: è·¯ç”±è·¯å¾„ï¼Œé»˜è®¤ç”Ÿæˆï¼Œä¾‹å¦‚ `src/pages/about` ä¼šç”Ÿæˆ `/about` ä½œä¸º path
- `parentId`: çˆ¶çº§è·¯ç”± idï¼Œå¦‚æœå­˜åœ¨é¡µé¢å±€éƒ¨è·¯ç”±æˆ–å…¨å±€è·¯ç”±ï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆ parentId ä¸ºå±€éƒ¨è·¯ç”± id æˆ–å…¨å±€è·¯ç”± id
- `requireLayout`: æ˜¯å¦éœ€è¦å±€éƒ¨è·¯ç”±æˆ–å…¨å±€è·¯ç”±ï¼Œé»˜è®¤ä¸º trueï¼Œå¦‚æœä¸º falseï¼Œåˆ™ä¸ä¼šç”Ÿæˆ parentId
- å…¶ä»–è‡ªå®šä¹‰å±æ€§

### ç¤ºä¾‹

æ–‡ä»¶ç»“æ„

```plaintext
src
â”œâ”€â”€ manage
â”‚   â”œâ”€â”€ index.tsx
â”œâ”€â”€ pages
â”‚   â”œâ”€â”€ index.tsx
â”‚   â”œâ”€â”€ about.tsx
â”‚   â”œâ”€â”€ about.meta.json
â”‚   â”œâ”€â”€ user
â”‚   â”‚   â”œâ”€â”€ index.tsx
â”‚   â”‚   â”œâ”€â”€ $id.tsx
â”‚   â”‚   â””â”€â”€ $id.meta.json
â”‚   â””â”€â”€ Layout.tsx
â”œâ”€â”€ layouts
â”‚   â””â”€â”€ index.tsx
```

è·¯ç”±é»˜è®¤å†™å…¥çš„ä½ç½®ä¸º `**/.virtual_routes/index.tsx` ï¼Œå’Œ `src` åŒçº§

ç”Ÿæˆçš„è·¯ç”±é…ç½®

```typescript
// @ts-nocheck
// this file is generated by webpack-plugin-auto-routes
// do not change anytime!
import React, { Suspense } from 'react';

function withLazyLoad(LazyComponent) {
  const lazyComponentWrapper = (props) => (
    <Suspense fallback={props.loadingComponent}>
      <LazyComponent {...props} />
    </Suspense>
  );
  return lazyComponentWrapper;
}

export function getRoutes() {
  const routes = {
    '@@pages-layout': { id: '@@pages-layout', path: '/layout', isLayout: true },
    'pages-about': {
      id: 'pages-about',
      path: '/about',
      parentId: '@@pages-layout',
    },
    index: { id: 'index', path: '/', parentId: '@@pages-layout' },
    'user-$id': {
      id: 'user-$id',
      path: '/user/:id',
      name: 'userId',
      parentId: '@@pages-layout',
    },
    user: { id: 'user', path: '/user', parentId: '@@pages-layout' },
    manage: { id: 'manage', path: '/manage', parentId: '@@global-layout' },
    '@@global-layout': { id: '@@global-layout', path: '/', isLayout: true },
  };
  return {
    routes,
    routeComponents: {
      '@@pages-layout': withLazyLoad(
        React.lazy(() => import('./src/pages/Layout.tsx'))
      ),
      'pages-about': withLazyLoad(
        React.lazy(() => import('./src/pages/about.tsx'))
      ),
      index: withLazyLoad(React.lazy(() => import('./src/pages/index.tsx'))),
      'user-$id': withLazyLoad(
        React.lazy(() => import('./src/pages/user/$id.tsx'))
      ),
      user: withLazyLoad(
        React.lazy(() => import('./src/pages/user/index.tsx'))
      ),
      manage: withLazyLoad(React.lazy(() => import('./src/manage/index.tsx'))),
      '@@global-layout': withLazyLoad(
        React.lazy(() => import('./src/layouts/index.tsx'))
      ),
    },
  };
}
```
